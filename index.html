<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Differential testing on the forest of trees output form TreeTerminus â€¢ mehenDi</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Differential testing on the forest of trees output form TreeTerminus">
<meta name="description" content="This package provides a tree based differential testing for RNA-Seq data, where the tree is obtained from \strong{TreeTerminus}. The candidate nodes can consist of both leaves and inner nodes, with inner nodes comprising a susbet of transcripts that exhibit high uncertainty.">
<meta property="og:description" content="This package provides a tree based differential testing for RNA-Seq data, where the tree is obtained from \strong{TreeTerminus}. The candidate nodes can consist of both leaves and inner nodes, with inner nodes comprising a susbet of transcripts that exhibit high uncertainty.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">mehenDi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/mehenDi.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NPSDC/mehenDi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="mehendi">mehenDi<a class="anchor" aria-label="anchor" href="#mehendi"></a>
</h1></div>
<div class="section level2">
<h2 id="mehendi-tree-based-differential-testing-using-inferential-uncertainty-for-rna-seq">mehenDi: Tree-based differential testing using inferential uncertainty for RNA-Seq<a class="anchor" aria-label="anchor" href="#mehendi-tree-based-differential-testing-using-inferential-uncertainty-for-rna-seq"></a>
</h2>
<p>The <strong>mehenDi</strong> method performs differential testing use the transcripts-tree obtained from <strong>TreeTerminus</strong>. The transcripts are arranged in a way such that the uncertainty decreases on ascending the tree, with the inner nodes comprising transcripts groups. <strong>mehenDi</strong> aims to leverage the tree structure to find differential signal in the tree which might get lost due to uncertainty. The selected nodes can consist of both transcripts and inner nodes, with inner nodes representing a set of transcripts that exhibit high uncertainty.</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<pre><code><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"NPSDC/mehenDi"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"NPSDC/brainSimSmall"</span><span class="op">)</span> <span class="co">## Download the package with a small dataset</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h3>
<div class="section level4">
<h4 id="loading-data">Loading Data<a class="anchor" aria-label="anchor" href="#loading-data"></a>
</h4>
<pre><code><span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"brainSimSmall"</span><span class="op">)</span></span>
<span><span class="va">clustFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir</span>, <span class="st">"cluster_nwk.txt"</span><span class="op">)</span></span>
<span><span class="va">quantDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir</span>, <span class="st">"salmon_quants"</span><span class="op">)</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,sep<span class="op">=</span><span class="st">'_'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">quantFiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">quantDir</span>, <span class="va">samples</span>, <span class="st">'quant.sf'</span><span class="op">)</span></span>
<span><span class="va">coldata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">quantFiles</span>, names<span class="op">=</span><span class="va">samples</span>, condition<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, each<span class="op">=</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu">beaveR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/beaveR/man/buildTSE.html" class="external-link">buildTSE</a></span><span class="op">(</span>treeTermFile <span class="op">=</span> <span class="va">clustFile</span>, coldata <span class="op">=</span> <span class="va">coldata</span><span class="op">)</span> <span class="co">## the path to a directory that contains Salmon quantified RNA-Seq samples and the corresponding forest file produced by TreeTerminus</span></span>
<span><span class="va">tse</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">TreeSummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TreeSummarizedExperiment/man/TreeSummarizedExperiment-accessor.html" class="external-link">rowTree</a></span><span class="op">(</span><span class="va">tse</span><span class="op">)</span></span>
<span><span class="va">tree</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tree</span><span class="op">$</span><span class="va">tip</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="running-mehendi">Running mehenDi<a class="anchor" aria-label="anchor" href="#running-mehendi"></a>
</h4>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mehenDi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">yTxps</span> <span class="op">&lt;-</span> <span class="va">tse</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">l</span>,<span class="op">]</span></span>
<span><span class="va">yTxps</span> <span class="op">&lt;-</span> <span class="fu">fishpond</span><span class="fu">::</span><span class="fu"><a href="https://thelovelab.github.io/fishpond/reference/swish.html" class="external-link">swish</a></span><span class="op">(</span><span class="va">yTxps</span>, x<span class="op">=</span><span class="st">"condition"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">yAll</span> <span class="op">&lt;-</span> <span class="fu">beaveR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/beaveR/man/computeSizeFactors.html" class="external-link">computeSizeFactors</a></span><span class="op">(</span><span class="va">tse</span><span class="op">)</span></span>
<span><span class="va">yAll</span> <span class="op">&lt;-</span> <span class="fu">beaveR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/beaveR/man/scInfReps.html" class="external-link">scInfReps</a></span><span class="op">(</span><span class="va">yAll</span><span class="op">)</span></span>
<span><span class="va">yAll</span> <span class="op">&lt;-</span> <span class="fu">fishpond</span><span class="fu">::</span><span class="fu"><a href="https://thelovelab.github.io/fishpond/reference/labelKeep.html" class="external-link">labelKeep</a></span><span class="op">(</span><span class="va">yAll</span><span class="op">)</span></span>
<span><span class="fu">metadata</span><span class="op">(</span><span class="va">yAll</span><span class="op">)</span><span class="op">$</span><span class="va">infRepsScaled</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">yInn</span> <span class="op">&lt;-</span> <span class="va">yAll</span><span class="op">[</span><span class="op">(</span><span class="va">l</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">yAll</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">yInn</span> <span class="op">&lt;-</span> <span class="fu">fishpond</span><span class="fu">::</span><span class="fu"><a href="https://thelovelab.github.io/fishpond/reference/swish.html" class="external-link">swish</a></span><span class="op">(</span><span class="va">yInn</span>, x<span class="op">=</span><span class="st">"condition"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">mcols</span><span class="op">(</span><span class="va">yTxps</span><span class="op">)</span><span class="op">[[</span><span class="st">"pvalue"</span><span class="op">]</span><span class="op">]</span>, <span class="fu">mcols</span><span class="op">(</span><span class="va">yInn</span><span class="op">)</span><span class="op">[[</span><span class="st">"pvalue"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">tD</span> <span class="op">&lt;-</span> <span class="fu">mehenDi</span><span class="fu">::</span><span class="fu"><a href="reference/mehenDi.html">mehenDi</a></span><span class="op">(</span><span class="va">yAll</span>, x<span class="op">=</span><span class="st">"condition"</span>, pvalues <span class="op">=</span> <span class="va">pvals</span>,</span>
<span>                    minP<span class="op">=</span><span class="fl">0.7</span>, mIRVThresh<span class="op">=</span><span class="fl">0.4</span>, alpha<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tD</span><span class="op">$</span><span class="va">selNodes</span><span class="op">)</span> <span class="co">## Total number of selected nodes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tD</span><span class="op">$</span><span class="va">selNodes</span> <span class="op">&gt;</span> <span class="va">l</span><span class="op">)</span> <span class="co">## Number of inner nodes that are selected</span></span></code></pre>
<p>The input to <strong>mehenDi</strong> is the <em>TreeSummarizedExperiment</em> (tse) object. This object can be created using the package <a href="https://github.com/NPSDC/beaver" class="external-link">beaveR</a>, which requires the same input as <a href="https://github.com/thelovelab/tximeta" class="external-link">tximeta</a> and the forest file produced by <a href="https://github.com/COMBINE-lab/TreeTerminus" class="external-link">TreeTerminus</a>. Among the other inputs are the p-values corresponding to each node in tree belonging to the <code>tse</code> object, which here in this example have been generated using <code>swish</code> in the package <a href="https://github.com/thelovelab/fishpond" class="external-link">fishpond</a>.</p>
</div>
<div class="section level4">
<h4 id="exploration-of-the-nodes-output-by-mehendi">Exploration of the nodes output by mehenDi<a class="anchor" aria-label="anchor" href="#exploration-of-the-nodes-output-by-mehendi"></a>
</h4>
<pre><code>fishpond::plotInfReps(yAll, tD[["selNodes]][1], x="condition")
nodeInf &lt;- beaveR::findNodeInformation(yAll, node = tD[["selNodes]][1], type = "tips")
nodeInf</code></pre>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/NPSDC/mehenDi/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mehenDi</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Noor Pratap Singh <br><small class="roles"> Author, maintainer </small>  </li>
<li>Michael Love <br><small class="roles"> Author, contributor </small>  </li>
<li>Rob Pato <br><small class="roles"> Author, contributor </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Noor Pratap Singh, Michael Love, Rob Pato.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
